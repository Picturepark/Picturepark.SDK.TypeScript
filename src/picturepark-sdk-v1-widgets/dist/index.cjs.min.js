"use strict";!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Liquid=e()}}((function(){return function e(t,r,n){function i(a,o){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){var r=t[a][1][e];return i(r||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t){function r(e){return i(e).replace(/&|<|>|"|'/g,(function(e){return c[e]}))}function n(e){var t=(e+"").split(".");return t.length>1?t[1].length:0}function i(e){return(e=e||"")+""}function s(e){return function(t,r){var i=function(e,t){return Math.max(n(e),n(t))}(t,r);return e(t,r).toFixed(i)}}function a(e){return l.forOwn(p,(function(t,r){return e.registerFilter(r,t)}))}var o=e("./src/util/strftime.js"),l=e("./src/util/underscore.js"),u=e("./src/syntax.js").isTruthy,c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},d={"&amp;":"&","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'"},p={abs:function(e){return Math.abs(e)},append:function(e,t){return e+t},capitalize:function(e){return i(e).charAt(0).toUpperCase()+e.slice(1)},ceil:function(e){return Math.ceil(e)},date:function(e,t){return"now"===e&&(e=new Date),e instanceof Date?o(e,t):""},default:function(e,t){return u(e)?e:t},divided_by:function(e,t){return Math.floor(e/t)},downcase:function(e){return e.toLowerCase()},escape:r,escape_once:function(e){return r(function(e){return i(e).replace(/&(amp|lt|gt|#34|#39);/g,(function(e){return d[e]}))}(e))},first:function(e){return e[0]},floor:function(e){return Math.floor(e)},join:function(e,t){return e.join(t)},last:function(e){return e[e.length-1]},lstrip:function(e){return i(e).replace(/^\s+/,"")},map:function(e,t){return e.map((function(e){return e[t]}))},minus:s((function(e,t){return e-t})),modulo:s((function(e,t){return e%t})),newline_to_br:function(e){return e.replace(/\n/g,"<br />")},plus:s((function(e,t){return Number(e)+Number(t)})),prepend:function(e,t){return t+e},remove:function(e,t){return e.split(t).join("")},remove_first:function(e,t){return e.replace(t,"")},replace:function(e,t,r){return i(e).split(t).join(r)},replace_first:function(e,t,r){return i(e).replace(t,r)},reverse:function(e){return e.reverse()},round:function(e,t){var r=Math.pow(10,t||0);return Math.round(e*r,t)/r},rstrip:function(e){return i(e).replace(/\s+$/,"")},size:function(e){return e.length},slice:function(e,t,r){return e.substr(t,void 0===r?1:r)},sort:function(e,t){return e.sort(t)},split:function(e,t){return i(e).split(t)},strip:function(e){return i(e).trim()},strip_html:function(e){return i(e).replace(/<\/?\s*\w+\s*\/?>/g,"")},strip_newlines:function(e){return i(e).replace(/\n/g,"")},times:function(e,t){return e*t},truncate:function(e,t,r){return r=void 0===r?"...":r,t=t||16,(e=i(e)).length<=t?e:e.substr(0,t-r.length)+r},truncatewords:function(e,t,r){void 0===r&&(r="...");var n=e.split(" "),i=n.slice(0,t).join(" ");return n.length>t&&(i+=r),i},uniq:function(e){var t={};return(e||[]).filter((function(e){return!t.hasOwnProperty(e)&&(t[e]=!0,!0)}))},upcase:function(e){return i(e).toUpperCase()},url_encode:encodeURIComponent};a.filters=p,t.exports=a},{"./src/syntax.js":13,"./src/util/strftime.js":20,"./src/util/underscore.js":21}],2:[function(e,t){function r(e){(e=i.assign({root:["."],cache:!1,extname:".liquid",trim_right:!1,trim_left:!1,strict_filters:!1,strict_variables:!1},e)).root=function(e){return i.isArray(e)?e:i.isString(e)?[e]:[]}(e.root);var t=Object.create(k);return t.init(p(),f(e),e),t}var n=e("./src/scope"),i=e("./src/util/underscore.js"),s=e("./src/util/assert.js"),a=e("./src/tokenizer.js"),o=e("./src/util/fs.js").statFileAsync,l=e("./src/util/fs.js").readFileAsync,u=e("path"),c=e("./src/render.js"),d=e("./src/lexical.js"),p=e("./src/tag.js"),f=e("./src/filter.js"),g=e("./src/parser"),h=e("./src/syntax.js"),m=e("./tags"),v=e("./filters"),w=e("any-promise"),y=e("./src/util/promise.js").anySeries,x=e("./src/util/error.js"),k={init:function(e,t,r){return r.cache&&(this.cache={}),this.options=r,this.tag=e,this.filter=t,this.parser=g(e,t),this.renderer=c(),m(this),v(this),this},parse:function(e,t){var r=a.parse(e,t,this.options);return this.parser.parse(r)},render:function(e,t,r){r=i.assign({},this.options,r);var s=n.factory(t,r);return this.renderer.renderTemplates(e,s)},parseAndRender:function(e,t,r){var n=this;return w.resolve().then((function(){return n.parse(e)})).then((function(e){return n.render(e,t,r)})).catch((function(e){if(e instanceof x.RenderBreakError)return e.html;throw e}))},renderFile:function(e,t,r){var n=this;return r=i.assign({},r),this.getTemplate(e,r.root).then((function(e){return n.render(e,t,r)}))},evalOutput:function(e,t){var r=this.parser.parseOutput(e.trim());return this.renderer.evalOutput(r,t)},registerFilter:function(e,t){return this.filter.register(e,t)},registerTag:function(e,t){return this.tag.register(e,t)},lookup:function(e,t){t=this.options.root.concat(t||[]);var r=(t=i.uniq(t)).map((function(t){return u.resolve(t,e)}));return y(r,(function(e){return o(e).then((function(){return e}))})).catch((function(r){throw"ENOENT"===r.code&&(r.message="Failed to lookup "+e+" in: "+t),r}))},getTemplate:function(e,t){var r=this;return u.extname(e)||(e+=this.options.extname),this.lookup(e,t).then((function(e){if(r.options.cache){var t=r.cache[e];return t?w.resolve(t):l(e).then((function(e){return r.parse(e)})).then((function(t){return r.cache[e]=t}))}return l(e).then((function(t){return r.parse(t,e)}))}))},express:function(e){e=e||{};var t=this;return function(r,n,a){s(i.isArray(this.root)||i.isString(this.root),"illegal views root, are you using express.js?"),e.root=this.root,t.renderFile(r,n,e).then((function(e){return a(null,e)})).catch((function(e){return a(e)}))}}};r.lexical=d,r.isTruthy=h.isTruthy,r.isFalsy=h.isFalsy,r.evalExp=h.evalExp,r.evalValue=h.evalValue,r.Types={ParseError:x.ParseError,TokenizationEroor:x.TokenizationError,RenderBreakError:x.RenderBreakError,AssertionError:x.AssertionError},t.exports=r},{"./filters":1,"./src/filter.js":7,"./src/lexical.js":8,"./src/parser":10,"./src/render.js":11,"./src/scope":12,"./src/syntax.js":13,"./src/tag.js":14,"./src/tokenizer.js":15,"./src/util/assert.js":16,"./src/util/error.js":17,"./src/util/fs.js":18,"./src/util/promise.js":19,"./src/util/underscore.js":21,"./tags":32,"any-promise":3,path:6}],3:[function(e,t){t.exports=e("./register")().Promise},{"./register":5}],4:[function(e,t){var r="@@any-promise/REGISTRATION",n=null;t.exports=function(e,t){return function(i,s){i=i||null;var a=!1!==(s=s||{}).global;if(null===n&&a&&(n=e[r]||null),null!==n&&null!==i&&n.implementation!==i)throw new Error('any-promise already defined as "'+n.implementation+'".  You can only register an implementation before the first  call to require("any-promise") and an implementation cannot be changed');return null===n&&(n=null!==i&&void 0!==s.Promise?{Promise:s.Promise,implementation:i}:t(i),a&&(e[r]=n)),n}}},{}],5:[function(e,t){t.exports=e("./loader")(window,(function(){if(void 0===window.Promise)throw new Error("any-promise browser requires a polyfill or explicit registration e.g: require('any-promise/register/bluebird')");return{Promise:window.Promise,implementation:"window.Promise"}}))},{"./loader":4}],6:[function(){},{}],7:[function(e,t){var r=e("./lexical.js"),n=e("./syntax.js"),i=e("./util/assert.js"),s=e("./util/underscore.js"),a=new RegExp(""+r.value.source,"g");t.exports=function(e){e=s.assign({},e);var t={},o={render:function(e,t){var r=this.args.map((function(e){return n.evalValue(e,t)}));return r.unshift(e),this.filter.apply(null,r)},parse:function(n){var s=r.filterLine.exec(n);i(s,"illegal filter: "+n);var o=s[1],l=s[2]||"",u=t[o];if("function"!=typeof u){if(e.strict_filters)throw new TypeError("undefined filter: "+o);return this.name=o,this.filter=function(e){return e},this.args=[],this}for(var c=[];s=a.exec(l.trim());){var d=s[0],p=new RegExp(d+"\\s*:","g");c.push(p.test(s.input)?"'"+d+"'":d)}return this.name=o,this.filter=u,this.args=c,this}};return{construct:function(e){return Object.create(o).parse(e)},register:function(e,r){t[e]=r},clear:function(){t={}}}}},{"./lexical.js":8,"./syntax.js":13,"./util/assert.js":16,"./util/underscore.js":21}],8:[function(e,t){var r=new RegExp(/'[^']*'/.source+"|"+/"[^"]*"/.source),n=new RegExp("(?:"+r.source+"|[^'\"])*"),i=/-?\d+/,s=/-?\d+\.?\d*|\.?\d+/,a=/true|false/,o=/[\w-]+/,l=new RegExp("\\[(?:"+r.source+"|[\\w-\\.]+)\\]"),u=new RegExp("(?:"+r.source+"|"+a.source+"|"+s.source+")"),c=new RegExp(o.source+"(?:\\."+o.source+"|"+l.source+")*"),d=new RegExp("(?:"+c.source+"|"+s.source+")"),p=new RegExp("\\("+d.source+"\\.\\."+d.source+"\\)"),f=new RegExp("\\(("+d.source+")\\.\\.("+d.source+")\\)"),g=new RegExp("(?:"+c.source+"|"+u.source+"|"+p.source+")"),h=new RegExp("(?:"+o.source+")\\s*:\\s*(?:"+g.source+")"),m=new RegExp("("+o.source+")\\s*:\\s*("+g.source+")","g"),v=new RegExp("^\\s*("+o.source+")\\s*([\\s\\S]*)\\s*$"),w=new RegExp("^"+u.source+"$","i"),y=new RegExp("^"+c.source+"$"),x=new RegExp("^"+s.source+"$"),k=new RegExp("^"+a.source+"$","i"),b=new RegExp("^"+r.source+"$"),j=new RegExp("^"+f.source+"$"),P=new RegExp("^"+i.source+"$"),E=new RegExp("(?:"+o.source+"\\s*:\\s*)?"+g.source),S=new RegExp(E.source+"(\\s*,\\s*"+E.source+")*"),_=new RegExp(o.source+"(?:\\s*:\\s*"+S.source+")?","g"),T=new RegExp("("+o.source+")(?:\\s*:\\s*("+S.source+"))?"),L=new RegExp("^"+T.source+"$");t.exports={quoted:r,number:s,bool:a,literal:u,filter:_,integer:i,hash:h,hashCapture:m,range:p,rangeCapture:f,identifier:o,value:g,quoteBalanced:n,operators:[/\s+or\s+/,/\s+and\s+/,/==|!=|<=|>=|<|>|\s+contains\s+/],quotedLine:b,numberLine:x,boolLine:k,rangeLine:j,literalLine:w,filterLine:L,tagLine:v,isLiteral:function(e){return w.test(e)},isVariable:function(e){return y.test(e)},parseLiteral:function(e){var t=e.match(x);return t?Number(e):(t=e.match(k))?"true"===e.toLowerCase():(t=e.match(b))?e.slice(1,-1):void 0},isRange:function(e){return j.test(e)},matchValue:function(e){return g.exec(e)},isInteger:function(e){return P.test(e)}}},{}],9:[function(e,t){t.exports={"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},">":function(e,t){return null!==e&&null!==t&&e>t},"<":function(e,t){return null!==e&&null!==t&&t>e},">=":function(e,t){return null!==e&&null!==t&&e>=t},"<=":function(e,t){return null!==e&&null!==t&&t>=e},contains:function(e,t){return!!e&&("function"==typeof e.indexOf&&e.indexOf(t)>-1)},and:function(e,t){return e&&t},or:function(e,t){return e||t}}},{}],10:[function(e,t){var r=e("./lexical.js"),n=e("./util/error.js").ParseError,i=e("./util/assert.js");t.exports=function(e,t){function s(e,t){try{var r=null;return(r="tag"===e.type?a(e,t):"output"===e.type?o(e.value):e).token=e,r}catch(t){throw new n(t,e)}}function a(t,r){return"continue"===t.name||"break"===t.name?t:e.construct(t,r)}function o(e){var n=r.matchValue(e);i(n,"illegal output string: "+e);var s=n[0];e=e.substr(n.index+n[0].length);for(var a=[];n=r.filter.exec(e);)a.push([n[0].trim()]);return{type:"output",initial:s,filters:a.map((function(e){return t.construct(e)}))}}var l={init:function(e){return this.tokens=e,this.handlers={},this},on:function(e,t){return this.handlers[e]=t,this},trigger:function(e,t){var r=this.handlers[e];return"function"==typeof r?(r(t),!0):void 0},start:function(){this.trigger("start");for(var e;!this.stopRequested&&(e=this.tokens.shift());)if(!(this.trigger("token",e)||"tag"===e.type&&this.trigger("tag:"+e.name,e))){var t=s(e,this.tokens);this.trigger("template",t)}return this.stopRequested||this.trigger("end"),this},stop:function(){return this.stopRequested=!0,this}};return{parse:function(e){for(var t,r=[];t=e.shift();)r.push(s(t,e));return r},parseTag:a,parseStream:function(e){return Object.create(l).init(e)},parseOutput:o}}},{"./lexical.js":8,"./util/assert.js":16,"./util/error.js":17}],11:[function(e,t){var r=e("./syntax.js"),n=e("any-promise"),i=e("./util/promise.js").mapSeries,s=e("./util/error.js").RenderBreakError,a=e("./util/error.js").RenderError,o=e("./util/assert.js"),l={renderTemplates:function(e,t){function r(e){var r=this;return"tag"===e.type?this.renderTag(e,t).then((function(e){return void 0===e?"":e})):"output"===e.type?n.resolve().then((function(){return r.evalOutput(e,t)})).then((function(e){return void 0===e?"":function(e){return"string"==typeof e?e:JSON.stringify(e)}(e)})):n.resolve(e.value)}var l=this;o(t,"unable to evalTemplates: scope undefined");var u="";return i(e,(function(e){return r.call(l,e).then((function(e){return u+=e})).catch((function(t){if(t instanceof s)throw t.resolvedHTML=u,t;throw new a(t,e)}))})).then((function(){return u}))},renderTag:function(e,t){return"continue"===e.name?n.reject(new s("continue")):"break"===e.name?n.reject(new s("break")):e.render(t)},evalOutput:function(e,t){return o(t,"unable to evalOutput: scope undefined"),e.filters.reduce((function(e,r){return r.render(e,t)}),r.evalExp(e.initial,t))}};t.exports=function(){return Object.create(l)}},{"./syntax.js":13,"./util/assert.js":16,"./util/error.js":17,"./util/promise.js":19,"any-promise":3}],12:[function(e,t,r){function n(e,t){for(var r=1,n=t;n<e.length;n++)if("["===e[n]&&r++,"]"===e[n]&&0===--r)return n;return-1}var i=e("./util/underscore.js"),s=e("./lexical.js"),a=e("./util/assert.js"),o=Object.prototype.toString,l={getAll:function(){for(var e={},t=this.scopes.length-1;t>=0;t--)i.assign(e,this.scopes[t]);return e},get:function(e){for(var t=this.scopes.length-1;t>=0;t--)try{return this.getPropertyByPath(this.scopes[t],e)}catch(t){if(/undefined variable/.test(t.message))continue;if(/Cannot read property/.test(t.message)){if(this.opts.strict_variables)throw t.message+=": "+e,t;continue}throw t.message+=": "+e,t}if(this.opts.strict_variables)throw new TypeError("undefined variable: "+e)},set:function(e,t){return this.setPropertyByPath(this.scopes[this.scopes.length-1],e,t),this},push:function(e){return a(e,"trying to push "+e+" into scopes"),this.scopes.push(e)},pop:function(){return this.scopes.pop()},unshift:function(e){return a(e,"trying to push "+e+" into scopes"),this.scopes.unshift(e)},shift:function(){return this.scopes.shift()},setPropertyByPath:function(e,t,r){if(i.isString(t))for(var n=t.replace(/\[/g,".").replace(/\]/g,"").split("."),s=0;s<n.length;s++){var a=n[s];if(s===n.length-1)return e[a]=r;void 0===e[a]&&(e[a]={}),e=e[a]||{}}},getPropertyByPath:function(e,t){var r=this.propertyAccessSeq(t+""),n=r.shift();if(!e.hasOwnProperty(n))throw new TypeError("undefined variable");var i=e[n],s=r.pop();if(r.forEach((function(e){return i=i[e]})),void 0!==s){if("size"===s&&("[object Array]"===o.call(i)||"[object String]"===o.call(i)))return i.length;i=i[s]}return i},propertyAccessSeq:function(e){for(var t=[],r="",i=0;i<e.length;i++)if("["===e[i]){t.push(r),r="";var o=e[i+1];if("'"!==o&&'"'!==o){var l=n(e,i+1);a(-1!==l,"unbalanced []: "+e),r=e.slice(i+1,l),t.push(s.isInteger(r)?r:this.get(r)),r="",i=l}else l=e.indexOf(o,i+2),a(-1!==l,"unbalanced "+o+": "+e),r=e.slice(i+2,l),t.push(r),r="",i=l+2}else"."===e[i]?(t.push(r),r=""):r+=e[i];return r.length&&t.push(r),t}};r.factory=function(e,t){t=i.assign({strict_variables:!1,strict_filters:!1,blocks:{},root:[]},t),e=i.assign(e,{liquid:t});var r=Object.create(l);return r.opts=t,r.scopes=[e],r}},{"./lexical.js":8,"./util/assert.js":16,"./util/underscore.js":21}],13:[function(e,t){function r(e,t){return(e=e&&e.trim())?s.isLiteral(e)?s.parseLiteral(e):s.isVariable(e)?t.get(e):void 0:void 0}function n(e){return!1===e||null==e}var i=e("./operators.js"),s=e("./lexical.js"),a=e("../src/util/assert.js");t.exports={evalExp:function e(t,n){a(n,"unable to evalExp: scope undefined");for(var o,l=s.operators,u=0;u<l.length;u++){var c=l[u],d=new RegExp("^("+s.quoteBalanced.source+")("+c.source+")("+s.quoteBalanced.source+")$");if(o=t.match(d)){var p=e(o[1],n);return(0,i[o[2].trim()])(p,e(o[3],n))}}if(o=t.match(s.rangeLine)){for(var f=r(o[1],n),g=r(o[2],n),h=[],m=f;g>=m;m++)h.push(m);return h}return r(t,n)},evalValue:r,isTruthy:function(e){return!n(e)},isFalsy:n}},{"../src/util/assert.js":16,"./lexical.js":8,"./operators.js":9}],14:[function(e,t){function r(e,t){var r,i={};for(n.hashCapture.lastIndex=0;r=n.hashCapture.exec(e);){var s=r[1],o=r[2];i[s]=a.evalValue(o,t)}return i}var n=e("./lexical.js"),i=e("./util/underscore.js"),s=e("any-promise"),a=e("./syntax.js"),o=e("./util/assert.js");t.exports=function(){var e={},t={render:function(e){var t=r(this.token.args,e),n=this.tagImpl;return"function"!=typeof n.render?s.resolve(""):s.resolve().then((function(){return"function"==typeof n.render?n.render(e,t):""})).catch((function(e){if(i.isError(e))throw e;var t="Please reject with an Error in "+n.render+", got "+e;throw new Error(t)}))},parse:function(t,r){this.type="tag",this.token=t,this.name=t.name;var n=e[this.name];o(n,"tag "+this.name+" not found"),this.tagImpl=Object.create(n),this.tagImpl.parse&&this.tagImpl.parse(t,r)}};return{construct:function(e,r){var n=Object.create(t);return n.parse(e,r),n},register:function(t,r){e[t]=r},clear:function(){e={}}}}},{"./lexical.js":8,"./syntax.js":13,"./util/assert.js":16,"./util/underscore.js":21,"any-promise":3}],15:[function(e,t,r){function n(e,t){(t=t||{}).trim_left&&(e=e.replace(/{%-?/g,"{%-")),t.trim_right&&(e=e.replace(/-?%}/g,"-%}"));var r=t.greedy?/\s+({%-)/g:/[\t\r ]*({%-)/g,n=t.greedy?/(-%})\s+/g:/(-%})[\t\r ]*\n?/g;return e.replace(r,"$1").replace(n,"$1")}var i=e("./lexical.js"),s=e("./util/error.js").TokenizationError,a=e("./util/underscore.js"),o=e("../src/util/assert.js");r.parse=function(e,t,r){function l(r,n,i){return{type:r,raw:i[n],value:i[n+1].trim(),line:u(i),input:e,file:t}}function u(e){var t=e.input.slice(m+1,e.index).split("\n");return v+=t.length-1,m=e.index,v+1}o(a.isString(e),"illegal input type"),e=n(e,r);for(var c,d,p,f=[],g=/({%-?([\s\S]*?)-?%})|({{([\s\S]*?)}})/g,h=0,m=-1,v=0;null!==(c=g.exec(e));){if(c.index>h&&(d=e.slice(h,c.index),f.push({type:"html",raw:d,value:d})),c[1]){var w=(p=l("tag",1,c)).value.match(i.tagLine);if(!w)throw new s("illegal tag syntax",p);p.name=w[1],p.args=w[2],f.push(p)}else p=l("output",3,c),f.push(p);h=g.lastIndex}return e.length>h&&(d=e.slice(h,e.length),f.push({type:"html",raw:d,value:d})),f},r.whiteSpaceCtrl=n},{"../src/util/assert.js":16,"./lexical.js":8,"./util/error.js":17,"./util/underscore.js":21}],16:[function(e,t){var r=e("./error.js").AssertionError;t.exports=function(e,t){if(!e){if(t instanceof Error)throw t;throw new r(t=t||"expect "+e+" to be true")}}},{"./error.js":17}],17:[function(e,t){function r(e,t){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.input=t.input,this.line=t.line,this.file=t.file;var r=o(t.input,t.line);this.message=u(e,t),this.stack=r+"\n"+(this.stack||"")}function n(e,t){c.assign(this,e),this.originalError=e,this.name=this.constructor.name,this.input=t.input,this.line=t.line,this.file=t.file;var r=o(t.input,t.line);this.message=u(e.message||"Unkown Error",t),this.stack=r+"\n"+(e.stack||"")}function i(e,t){if(e instanceof i)return e;c.assign(this,e),this.originalError=e,this.name=this.constructor.name,this.input=t.token.input,this.line=t.token.line,this.file=t.token.file;var r=o(t.token.input,t.token.line);this.message=u(e.message||"Unkown Error",t.token),this.stack=r+"\n"+(e.stack||"")}function s(e){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e||""}function a(e){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e}function o(e,t){var r=e.split("\n"),n=Math.max(t-2,1),i=Math.min(t+3,r.length),s=c.range(n,i+1).map((function(e){return[e===t?">> ":"   ",l(e,i),"| ",r[e-1]].join("")})).join("\n");return s}function l(e,t){var r=e+"";return Array((t+"").length-r.length).join(" ")+r}function u(e,t){return e=e||"",t.file&&(e+=", file:"+t.file),t.line&&(e+=", line:"+t.line),e}var c=e("./underscore.js");r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,t.exports={TokenizationError:r,ParseError:n,RenderBreakError:s,AssertionError:a,RenderError:i}},{"./underscore.js":21}],18:[function(e,t){var r=e("fs");t.exports={readFileAsync:function(e){return new Promise((function(t,n){r.readFile(e,"utf8",(function(e,r){e?n(e):t(r)}))}))},statFileAsync:function(e){return new Promise((function(t,n){r.stat(e,(function(e,r){return e?n(e):t(r)}))}))}}},{fs:6}],19:[function(e,t,r){var n=e("any-promise");r.anySeries=function(e,t){var r=n.reject(new Error("init"));return e.forEach((function(n,i){r=r.catch((function(){return t(n,i,e)}))})),r},r.mapSeries=function(e,t){var r=n.resolve("init"),i=[];return e.forEach((function(n,s){r=r.then((function(){return t(n,s,e)})).then((function(e){return i.push(e)}))})),r.then((function(){return i}))}},{"any-promise":3}],20:[function(e,t){var r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a={1:"st",2:"nd",3:"rd",default:"th"},o={daysInMonth:function(e){return[31,o.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31]},getDayOfYear:function(e){for(var t=0,r=0;r<e.getMonth();++r)t+=o.daysInMonth(e)[r];return t+e.getDate()},getWeekOfYear:function(e,t){var r=this.getDayOfYear(e)+(t-e.getDay()),n=7-new Date(e.getFullYear(),0,1).getDay()+t;return l.pad(Math.floor((r-n)/7)+1,2)},isLeapYear:function(e){var t=e.getFullYear();return!(3&t||!(t%100||t%400==0&&t))},getSuffix:function(e){var t=e.getDate().toString(),r=parseInt(t.slice(-1));return a[r]||a.default},century:function(e){return parseInt(e.getFullYear().toString().substring(0,2),10)}},l={pad:function(e,t,r){r||(r="0");for(var n=e.toString(),i=t-n.length;i-- >0;)n=r+n;return n}},u={a:function(e){return s[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return n[e.getMonth()]},B:function(e){return r[e.getMonth()]},c:function(e){return e.toLocaleString()},C:function(e){return o.century(e)},d:function(e){return l.pad(e.getDate(),2)},e:function(e){return l.pad(e.getDate(),2," ")},H:function(e){return l.pad(e.getHours(),2)},I:function(e){return l.pad(e.getHours()%12||12,2)},j:function(e){return l.pad(o.getDayOfYear(e),3)},k:function(e){return l.pad(e.getHours(),2," ")},l:function(e){return l.pad(e.getHours()%12||12,2," ")},L:function(e){return l.pad(e.getMilliseconds(),3)},m:function(e){return l.pad(e.getMonth()+1,2)},M:function(e){return l.pad(e.getMinutes(),2)},p:function(e){return e.getHours()<12?"AM":"PM"},P:function(e){return e.getHours()<12?"am":"pm"},q:function(e){return o.getSuffix(e)},s:function(e){return Math.round(e.valueOf()/1e3)},S:function(e){return l.pad(e.getSeconds(),2)},u:function(e){return e.getDay()||7},U:function(e){return o.getWeekOfYear(e,0)},w:function(e){return e.getDay()},W:function(e){return o.getWeekOfYear(e,1)},x:function(e){return e.toLocaleDateString()},X:function(e){return e.toLocaleTimeString()},y:function(e){return e.getFullYear().toString().substring(2,4)},Y:function(e){return e.getFullYear()},z:function(e){var t=e.getTimezoneOffset()/60*100;return(t>0?"-":"+")+l.pad(Math.abs(t),4)},"%":function(){return"%"}};u.h=u.b,u.N=u.L;t.exports=function(e,t){for(var r="",n=t;;){var i=/%./g,s=i.exec(n);if(!s)return r+n;r+=n.slice(0,i.lastIndex-2),n=n.slice(i.lastIndex);var a=s[0].charAt(1),o=u[a];r+=o?o.call(this,e):"%"+a}}},{}],21:[function(e,t,r){function n(e,t){for(var r in e=e||{})if(e.hasOwnProperty(r)&&!1===t(e[r],r,e))break;return e}function i(e){return null!==e&&"object"===(void 0===e?"undefined":s(e))}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};r.isString=function(e){return e instanceof String||"string"==typeof e},r.isArray=function(e){return e instanceof Array},r.isObject=i,r.isError=function(e){return"Error"===Object.prototype.toString.call(e).substr(-6,5)||"string"==typeof e.message&&"string"==typeof e.name},r.range=function(e,t,r){1===arguments.length&&(t=e,e=0),r=r||1;for(var n=[],i=e;t>i;i+=r)n.push(i);return n},r.forOwn=n,r.assign=function(e){return e=i(e)?e:{},Array.prototype.slice.call(arguments,1).forEach((function(t){!function(e,t){e&&n(t,(function(t,r){e[r]=t}))}(e,t)})),e},r.uniq=function(e){for(var t={},r=[],n=0,i=e.length;i>n;++n)t.hasOwnProperty(e[n])||(r.push(e[n]),t[e[n]]=1);return r},r.echo=function(e){return function(t){return console.log("["+e+"]",t),t}}},{}],22:[function(e,t){var r=e("..").lexical,n=e("any-promise"),i=new RegExp("("+r.identifier.source+")\\s*=(.*)"),s=e("../src/util/assert.js");t.exports=function(e){e.registerTag("assign",{parse:function(e){var t=e.args.match(i);s(t,"illegal token "+e.raw),this.key=t[1],this.value=t[2]},render:function(t){return t.set(this.key,e.evalOutput(this.value,t)),n.resolve("")}})}},{"..":2,"../src/util/assert.js":16,"any-promise":3}],23:[function(e,t){var r=e("..").lexical,n=new RegExp("("+r.identifier.source+")"),i=e("../src/util/assert.js");t.exports=function(e){e.registerTag("capture",{parse:function(t,r){var s=this,a=t.args.match(n);i(a,t.args+" not valid identifier"),this.variable=a[1],this.templates=[];var o=e.parser.parseStream(r);o.on("tag:endcapture",(function(){return o.stop()})).on("template",(function(e){return s.templates.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")})),o.start()},render:function(t){var r=this;return e.renderer.renderTemplates(this.templates,t).then((function(e){t.set(r.variable,e)}))}})}},{"..":2,"../src/util/assert.js":16}],24:[function(e,t){var r=e("..");e("../src/util/assert.js"),t.exports=function(e){e.registerTag("case",{parse:function(t,r){var n=this;this.cond=t.args,this.cases=[],this.elseTemplates=[];var i=[],s=e.parser.parseStream(r).on("tag:when",(function(e){n.cases[e.args]||n.cases.push({val:e.args,templates:i=[]})})).on("tag:else",(function(){return i=n.elseTemplates})).on("tag:endcase",(function(){return s.stop()})).on("template",(function(e){return i.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")}));s.start()},render:function(t){for(var n=0;n<this.cases.length;n++){var i=this.cases[n];if(r.evalExp(i.val,t)===r.evalExp(this.cond,t))return e.renderer.renderTemplates(i.templates,t)}return e.renderer.renderTemplates(this.elseTemplates,t)}})}},{"..":2,"../src/util/assert.js":16}],25:[function(e,t){t.exports=function(e){e.registerTag("comment",{parse:function(t,r){var n=e.parser.parseStream(r);n.on("token",(function(e){"endcomment"===e.name&&n.stop()})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")})),n.start()}})}},{}],26:[function(e,t){var r=e(".."),n=e("any-promise"),i=r.lexical,s=new RegExp("^(?:("+i.value.source+")\\s*:\\s*)?(.*)$"),a=new RegExp(i.value.source,"g"),o=e("../src/util/assert.js");t.exports=function(e){e.registerTag("cycle",{parse:function(e){var t=s.exec(e.args);o(t,"illegal tag: "+e.raw),this.group=t[1]||"";var r=t[2];for(this.candidates=[];t=a.exec(r);)this.candidates.push(t[0]);o(this.candidates.length,"empty candidates: "+e.raw)},render:function(e){var t="cycle:"+r.evalValue(this.group,e)+":"+this.candidates.join(","),i=e.get("liquid"),s=i[t];void 0===s&&(s=i[t]=0);var a=this.candidates[s];return s=(s+1)%this.candidates.length,i[t]=s,n.resolve(r.evalValue(a,e))}})}},{"..":2,"../src/util/assert.js":16,"any-promise":3}],27:[function(e,t){var r=e("..").lexical,n=e("../src/util/assert.js");t.exports=function(e){e.registerTag("decrement",{parse:function(e){var t=e.args.match(r.identifier);n(t,"illegal identifier "+e.args),this.variable=t[0]},render:function(e){var t=e.get(this.variable);"number"!=typeof t&&(t=0),e.set(this.variable,t-1)}})}},{"..":2,"../src/util/assert.js":16}],28:[function(e,t){var r=e(".."),n=r.lexical,i=e("../src/util/promise.js").mapSeries,s=r.Types.RenderBreakError,a=e("../src/util/assert.js"),o=new RegExp("^("+n.identifier.source+")\\s+in\\s+("+n.value.source+")(?:\\s+"+n.hash.source+")*(?:\\s+(reversed))?(?:\\s+"+n.hash.source+")*$");t.exports=function(e){e.registerTag("for",{parse:function(t,r){var n=this,i=o.exec(t.args);a(i,"illegal tag: "+t.raw),this.variable=i[1],this.collection=i[2],this.reversed=!!i[3],this.templates=[],this.elseTemplates=[];var s,l=e.parser.parseStream(r).on("start",(function(){return s=n.templates})).on("tag:else",(function(){return s=n.elseTemplates})).on("tag:endfor",(function(){return l.stop()})).on("template",(function(e){return s.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")}));l.start()},render:function(t,n){var a=this,o=r.evalExp(this.collection,t);if(!Array.isArray(o)||Array.isArray(o)&&0===o.length)return e.renderer.renderTemplates(this.elseTemplates,t);var l=o.length,u=n.offset||0,c=void 0===n.limit?o.length:n.limit;o=o.slice(u,u+c),this.reversed&&o.reverse();var d=o.map((function(e,t){var r={};return r[a.variable]=e,r.forloop={first:0===t,index:t+1,index0:t,last:t===l-1,length:l,rindex:l-t,rindex0:l-t-1,stop:!1,skip:!1},r})),p="";return i(d,(function(r){return t.push(r),e.renderer.renderTemplates(a.templates,t).then((function(e){return p+=e})).catch((function(e){if(!(e instanceof s&&(p+=e.resolvedHTML,"continue"===e.message)))throw e})).then((function(){return t.pop()}))})).catch((function(e){if(!(e instanceof s&&"break"===e.message))throw e})).then((function(){return p}))}})}},{"..":2,"../src/util/assert.js":16,"../src/util/promise.js":19}],29:[function(e,t){var r=e("..");t.exports=function(e){e.registerTag("if",{parse:function(t,r){var n=this;this.branches=[],this.elseTemplates=[];var i,s=e.parser.parseStream(r).on("start",(function(){return n.branches.push({cond:t.args,templates:i=[]})})).on("tag:elsif",(function(e){n.branches[e.args]||n.branches.push({cond:e.args,templates:i=[]})})).on("tag:else",(function(){return i=n.elseTemplates})).on("tag:endif",(function(){return s.stop()})).on("template",(function(e){return i.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")}));s.start()},render:function(t){for(var n=0;n<this.branches.length;n++){var i=this.branches[n],s=r.evalExp(i.cond,t);if(r.isTruthy(s))return e.renderer.renderTemplates(i.templates,t)}return e.renderer.renderTemplates(this.elseTemplates,t)}})}},{"..":2}],30:[function(e,t){var r=e(".."),n=r.lexical,i=new RegExp("with\\s+("+n.value.source+")"),s=e("../src/util/assert.js");t.exports=function(e){e.registerTag("include",{parse:function(e){var t=n.value.exec(e.args);s(t,"illegal token "+e.raw),this.value=t[0],(t=i.exec(e.args))&&(this.with=t[1])},render:function(t,n){var i=r.evalValue(this.value,t),s=t.get("liquid"),a=s.blocks;return s.blocks={},this.with&&(n[i]=r.evalValue(this.with,t)),e.getTemplate(i,s.root).then((function(r){return t.push(n),e.renderer.renderTemplates(r,t)})).then((function(e){return t.pop(),s.blocks=a,e}))}})}},{"..":2,"../src/util/assert.js":16}],31:[function(e,t){var r=e(".."),n=e("../src/util/assert.js"),i=r.lexical;t.exports=function(e){e.registerTag("increment",{parse:function(e){var t=e.args.match(i.identifier);n(t,"illegal identifier "+e.args),this.variable=t[0]},render:function(e){var t=e.get(this.variable);"number"!=typeof t&&(t=0),e.set(this.variable,t+1)}})}},{"..":2,"../src/util/assert.js":16}],32:[function(e,t){t.exports=function(t){e("./assign.js")(t),e("./capture.js")(t),e("./case.js")(t),e("./comment.js")(t),e("./cycle.js")(t),e("./decrement.js")(t),e("./for.js")(t),e("./if.js")(t),e("./include.js")(t),e("./increment.js")(t),e("./layout.js")(t),e("./raw.js")(t),e("./tablerow.js")(t),e("./unless.js")(t)}},{"./assign.js":22,"./capture.js":23,"./case.js":24,"./comment.js":25,"./cycle.js":26,"./decrement.js":27,"./for.js":28,"./if.js":29,"./include.js":30,"./increment.js":31,"./layout.js":33,"./raw.js":34,"./tablerow.js":35,"./unless.js":36}],33:[function(e,t){var r=e(".."),n=e("any-promise"),i=r.lexical,s=e("../src/util/assert.js");t.exports=function(e){e.registerTag("layout",{parse:function(t,r){var n=i.value.exec(t.args);s(n,"illegal token "+t.raw),this.layout=n[0],this.tpls=e.parser.parse(r)},render:function(t,n){var i=r.evalValue(this.layout,t),s=t.get("liquid");return e.renderer.renderTemplates(this.tpls,t).then((function(){return e.getTemplate(i,s.root)})).then((function(e){return t.push(n),e})).then((function(r){return e.renderer.renderTemplates(r,t)})).then((function(e){return t.pop(),e}))}}),e.registerTag("block",{parse:function(t,r){var n=this,i=/\w+/.exec(t.args);this.block=i?i[0]:"anonymous",this.tpls=[];var s=e.parser.parseStream(r).on("tag:endblock",(function(){return s.stop()})).on("template",(function(e){return n.tpls.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")}));s.start()},render:function(t){var r=this,i=t.get("liquid"),s=i.blocks[this.block];return void 0===s?e.renderer.renderTemplates(this.tpls,t).then((function(e){return i.blocks[r.block]=e,e})):(i.blocks[this.block]=s,n.resolve(s))}})}},{"..":2,"../src/util/assert.js":16,"any-promise":3}],34:[function(e,t){var r=e("any-promise");t.exports=function(e){e.registerTag("raw",{parse:function(t,r){var n=this;this.tokens=[];var i=e.parser.parseStream(r);i.on("token",(function(e){"endraw"===e.name?i.stop():n.tokens.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")})),i.start()},render:function(){var e=this.tokens.map((function(e){return e.raw})).join("");return r.resolve(e)}})}},{"any-promise":3}],35:[function(e,t){var r=e(".."),n=e("any-promise"),i=r.lexical,s=e("../src/util/assert.js"),a=new RegExp("^("+i.identifier.source+")\\s+in\\s+("+i.value.source+")(?:\\s+"+i.hash.source+")*$");t.exports=function(e){e.registerTag("tablerow",{parse:function(t,r){var n=this,i=a.exec(t.args);s(i,"illegal tag: "+t.raw),this.variable=i[1],this.collection=i[2],this.templates=[];var o,l=e.parser.parseStream(r).on("start",(function(){return o=n.templates})).on("tag:endtablerow",(function(){return l.stop()})).on("template",(function(e){return o.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")}));l.start()},render:function(t,i){var s,a,o=this,l=r.evalExp(this.collection,t)||[],u="<table>",c=i.offset||0,d=void 0===i.limit?l.length:i.limit,p=i.cols;if(!p)throw new Error("illegal cols: "+p);l=l.slice(c,c+d);var f=[];l.some((function(e){var t={};t[o.variable]=e,f.push(t)}));var g=f.reduce((function(r,n,i){return r.then((function(){return s=Math.floor(i/p)+1,1===(a=i%p+1)&&(1!==s&&(u+="</tr>"),u+='<tr class="row'+s+'">'),u+='<td class="col'+a+'">'})).then((function(){return t.push(n),e.renderer.renderTemplates(o.templates,t)})).then((function(e){return t.pop(n),u+=e,u+="</td>"}))}),n.resolve(""));return g.then((function(){return s>0&&(u+="</tr>"),u+="</table>"})).catch((function(e){throw e}))}})}},{"..":2,"../src/util/assert.js":16,"any-promise":3}],36:[function(e,t){var r=e("..");t.exports=function(e){e.registerTag("unless",{parse:function(t,r){var n=this;this.templates=[],this.elseTemplates=[];var i,s=e.parser.parseStream(r).on("start",(function(){i=n.templates,n.cond=t.args})).on("tag:else",(function(){return i=n.elseTemplates})).on("tag:endunless",(function(){return s.stop()})).on("template",(function(e){return i.push(e)})).on("end",(function(){throw new Error("tag "+t.raw+" not closed")}));s.start()},render:function(t){var n=r.evalExp(this.cond,t);return r.isFalsy(n)?e.renderer.renderTemplates(this.templates,t):e.renderer.renderTemplates(this.elseTemplates,t)}})}},{"..":2}]},{},[2])(2)}));class PictureparkTemplates{static getTemplate(e){return"card"===e?this.getCard():"gallery"===e?this.getGallery():"list"===e?this.getList():"Template '"+e+"' not found."}static getGallery(){return'\n      {% if config.renderStyles %}\n      <style>\n        * {\n          box-sizing: border-box;\n        }\n\n       .picturepark-widget-content-preview {\n         background-color: white;\n         padding: 40px;\n        }\n        .picturepark-widget-gallery-{{id}} {\n          float: left;\n          width: 100%;\n          position: relative;\n          margin-right: -4px;\n          margin-bottom: -4px;\n        }\n        .picturepark-widget-gallery-item-{{id}} {\n          overflow: hidden;\n          background: #eeeeee;\n          margin-right: 4px;\n          margin-bottom: 4px;\n          position: relative;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n        .picturepark-widget-gallery-item-image-{{id}} {\n          position: absolute;\n          margin: auto;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n        .picturepark-widget-gallery-item-thumbnail-{{id}} {\n          \n        }\n\n        .picturepark-widget-gallery-item-title-{{id}} {\n          opacity: 0;\n          position: absolute;\n          width: 100%;\n          bottom: 0px;\n          background: gray;\n          padding: 4px;\n          color: white;\n        }\n        .picturepark-widget-gallery-item-{{id}}:hover \n        .picturepark-widget-gallery-item-title-{{id}} {\n          opacity: .8;\n        }\n\n        .picturepark-widget-gallery-item-preview-{{id}} {\n          opacity: 0;\n          position: absolute;\n          left: 43%;\n          top: 50%;\n          transform: translate(-50%, -50%);\n          background-color: gray;\n          border-radius: 50%;\n          color: white;\n          padding: 10px;\n          cursor: pointer;\n          display: flex;\n        }\n        .picturepark-widget-gallery-item-{{id}}:hover \n        .picturepark-widget-gallery-item-preview-{{id}} {\n          opacity: .8;\n        }\n\n       .picturepark-widget-gallery-item-outputs-{{id}} {\n          opacity: 0;\n          position: absolute;\n          left: 57%;\n          top: 50%;\n          transform: translate(-50%, -50%);\n          background-color: gray;\n          border-radius: 50%;\n          color: white;\n          padding: 10px;\n          cursor: pointer;\n          display: flex;\n        }\n        .picturepark-widget-gallery-item-{{id}}:hover \n        .picturepark-widget-gallery-item-outputs-{{id}} {\n          opacity: .8;\n        }\n        .picturepark-widget-gallery-item-outputs-dropdown-{{id}} {\n          position: absolute;\n          display: none;\n          background-color: #f1f1f1;\n          min-width: 160px;\n          max-height: 340px;\n          overflow: auto;\n          box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\n          z-index: 1;\n        }\n        .picturepark-widget-gallery-item-outputs-dropdown-{{id}}.show {\n          display: block;\n        }\n        .picturepark-widget-gallery-item-outputs-dropdown-{{id}} a {\n          color: black;\n          padding: 12px 16px;\n          text-decoration: none;\n          display: block;\n        }\n        .picturepark-widget-gallery-item-outputs-dropdown-{{id}} a:hover {\n          background-color: #ddd;\n        }\n      </style>\n      {% endif %}\n\n      <div class="picturepark-widget-gallery picturepark-widget-gallery-{{id}}">\n        {% assign width = config.width | plus: -2 %}\n        {% assign height = config.height | plus: -1 %}\n        {% for selection in share.items %}\n          <div class="picturepark-widget-gallery-item picturepark-widget-gallery-item-{{id}}" style="float: left; width: {{ config.width }}px; height: {{ config.height }}px">\n            {% if selection.isMovie and config.showPlayers == true %}\n              <video class="video-js" id="vjsplayer_{{ forloop.index0 }}_{{ id }}"></video>\n            {% elsif selection.isAudio and config.showPlayers == true %}\n              <audio class="video-js" id="vjsplayer_{{ forloop.index0 }}_{{ id }}"></audio>\n            {% else %}\n              {% if selection.isBinary == false %}\n                <div class="picturepark-widget-gallery-item-thumbnail picturepark-widget-gallery-item-thumbnail-{{id}}">{{ selection.displayValues.thumbnail }}</div>\n              {% else %}\n                <img class="picturepark-widget-gallery-item-image picturepark-widget-gallery-item-image-{{id}}" src="{% resizeById selection.id \'Preview\' width height %}" />\n                <div class="picturepark-widget-gallery-item-title picturepark-widget-gallery-item-title-{{id}}">{{selection.displayValues.name}}</div>\n              {% endif %}\n              <div class="picturepark-widget-gallery-item-preview picturepark-widget-gallery-item-preview-{{id}}" onclick="javascript:pictureparkWidgets.players.showDetail(\'{{ config.token }}\', \'{{ selection.id }}\', \'{{ id }}\')">\n                <svg style="width:24px;height:24px" viewBox="0 0 24 24">\n                    <path fill="#ffffff" d="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17V19H5V14H7V17H10Z" />\n                </svg>\n              </div>\n              <div class="picturepark-widget-gallery-item-outputs-{{id}}">\n                <svg style="width:24px;height:24px" viewBox="0 0 24 24">\n                  <path fill="#ffffff" d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z" />\n\t            </svg>\n              </div>\n              <div class="picturepark-widget-gallery-item-outputs-dropdown-{{id}}">\n                {% for output in selection.outputs %}\n                  <a href="{{ output.downloadUrl }}" target="_blank" download>{% translate output.outputFormatId %}</a>\n                {% endfor %}\n              </div>\n            {% endif %}\n          </div>\n        {% endfor %}\n    </div>\n    <br style="clear: both;" />'}static getCard(){return'\n      {% if config.renderStyles %}\n      <style>\n       .picturepark-widget-content-preview {\n         background-color: white;\n         padding: 40px;\n        }\n        .picturepark-widget-{{id}} {\n          all: initial;\n          font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;\n          font-size: 13px;\n          float: left;\n          margin-right: 4px;\n          margin-bottom: 4px;\n        }\n        .picturepark-widget-card-{{id}} {\n          border: 1px solid lightgray;\n          border-radius: 0 0 4px 4px;\n        }\n\n        /** Footer */\n        .picturepark-widget-card-footer-content-{{id}} {\n          padding: 10px;\n        }\n        .picturepark-widget-card-footer-title-{{id}} {\n          font-weight: bold;\n        }\n        .picturepark-widget-card-footer-description-{{id}} {\n        }\n        .picturepark-widget-card-footer-gravatar-{{id}} {\n          border-radius: 50%;\n          margin-top: 0px;\n        }\n        .picturepark-widget-card-footer-gravatar-{{id}} {\n          vertical-align: middle;\n        }\n        .picturepark-widget-card-footer-hr-{{id}} {\n          color: lightgray;\n          margin-top: 8px;\n          margin-bottom: 8px;\n        }\n\n        /** Gallery */\n        .picturepark-widget-card-gallery-{{id}} {\n          line-height: 0;\n          overflow: hidden;\n          max-height: {{ config.width }};\n        }\n        .picturepark-widget-card-gallery-image-{{id}} {\n          position: absolute;\n          margin: auto;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n\n        /** Overlay */\n        .picturepark-widget-card-overlay-{{id}} {\n          opacity: 0;\n          position: absolute;\n          width: 100%;\n          bottom: 0px;\n          background: gray;\n          padding: 4px;\n        }\n        .picturepark-widget-{{id}}:hover\n        .picturepark-widget-card-overlay-{{id}} {\n          opacity: 0.8;\n        }\n        .picturepark-widget-card-overlay-title-{{id}} {\n          font-weight: bold;\n          color: white;\n        }\n        .picturepark-widget-card-overlay-description-{{id}} {\n          color: white;\n        }\n\n        /** Navigation */\n        .picturepark-widget-card-navigation-previous-{{id}} {\n          position: absolute; \n          left: 0; \n          top: 0; \n          bottom: 0; \n          width: 30px; \n          margin-top: 50px; \n          margin-bottom: 50px\n        }\n        .picturepark-widget-card-navigation-next-{{id}} {\n          position: absolute; \n          right: 0; \n          top: 0; \n          bottom: 0; \n          width: 30px; \n          margin-top: 50px; \n          margin-bottom: 50px\n        }\n      </style>\n      {% endif %}\n\n      <div class="picturepark-widget-card picturepark-widget-card-{{id}}" style="width: {{ config.width }}px">\n        <div style="position: relative">\n          {% assign width = config.width | plus: -2 %}\n          {% assign height = config.height | plus: -1 %}\n          <div id="gallery_{{ id }}" style="height: {{ height }}px; width: {{ width }}px; position: relative">\n            {% for selection in share.items %}\n            <div class="picturepark-widget-card-gallery picturepark-widget-card-gallery-{{id}}"\n            {% if forloop.first == false %}style="display: none"{% endif %}>\n            {% if selection.isMovie and config.showPlayers != false %}\n              <video class="video-js" id="vjsplayer_{{ forloop.index0 }}_{{ id }}"></video>\n            {% elsif selection.isAudio and config.showPlayers != false %}\n              <audio class="video-js" id="vjsplayer_{{ forloop.index0 }}_{{ id }}"></audio>\n            {% else %}\n              <a href="javascript:void(0)" onclick="javascript:pictureparkWidgets.players.showDetail(\'{{ config.token }}\', \'{{ selection.id }}\', \'{{ id }}\')">\n              {% if selection.isBinary == false %}\n                <div class="picturepark-widget-gallery-item-thumbnail picturepark-widget-gallery-item-thumbnail-{{id}}">{{ selection.displayValues.thumbnail }}</div>\n              {% else %}\n                <img class="picturepark-widget-gallery-item-image picturepark-widget-gallery-item-image-{{id}}" src="{% resizeById selection.id \'Preview\' width height %}" />\n              {% endif %}\n              </a>\n              {% endif %}\n              \n              {% if config.showLogo %}\n              <div style="position: absolute; bottom: 4px; right: 8px;">\n                <svg style="width: 120px;" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 690.93 75.96">\n                  <defs>\n                    <style>.cls-1{fill:#5b7d89;}.cls-2{fill:#818181;}.cls-3,.cls-4,.cls-5{fill:#fff;}.cls-4,.cls-5{filter:url(#AI_Shadow_1);}.cls-4{font-size:67.44px;font-family:Roboto-Regular, Roboto;}.cls-5{font-size:46.07px;font-family:Roboto-Light, Roboto;letter-spacing:-0.01em;}.cls-6{letter-spacing:0em;}</style>\n                    <filter id="AI_Shadow_1" name="AI_Shadow_1"><feGaussianBlur result="blur" stdDeviation="2" in="SourceAlpha"/>\n                      <feOffset result="offsetBlurredAlpha" dx="4" dy="4" in="blur"/><feMerge><feMergeNode in="offsetBlurredAlpha"/>\n                      <feMergeNode in="SourceGraphic"/></feMerge>\n                    </filter>\n                  </defs>\n                  <title>powered-by-pp</title>\n                  <path class="cls-1" d="M344.17,152.27V117.83a4.58,4.58,0,0,0-4.28-4.83h-53.6a4.58,4.58,0,0,0-4.29,4.83v34.44Z" transform="translate(-19.07 -110.92)"/>\n                  <path class="cls-2" d="M282,161.87v11.31a4.58,4.58,0,0,0,4.28,4.82h53.6a4.57,4.57,0,0,0,4.28-4.82V161.87Z" transform="translate(-19.07 -110.92)"/>\n                  <polygon class="cls-3" points="325.09 50.95 262.93 50.95 262.93 41.35 325.09 41.35 325.09 50.95 325.09 50.95"/>\n                  <text class="cls-4" transform="translate(347.46 57.69)">Fotoware Alto</text>\n                  <text class="cls-5" transform="translate(0 57.66)">P<tspan class="cls-6" x="28.07" y="0">owered by</tspan></text>\n                </svg>\n              </div>\n              {% endif %}\n            </div>\n            {% endfor %}\n          </div>\n\n          {% if config.showOverlay %}\n            <div class="picturepark-widget-card-overlay picturepark-widget-card-overlay-{{id}}">\n              <div class="picturepark-widget-card-overlay-title picturepark-widget-card-overlay-title-{{id}}">{{ share.name }}</div>\n              {% if share.description %}\n                <div class="picturepark-widget-card-overlay-description picturepark-widget-card-overlay-description-{{id}}">{{ share.description }}</div>\n              {% endif %}\n            </div>\n          {% endif %}\n\n          {% if config.showNavigation and share.items.length > 1 %}\n          <a href="javascript:void(0)" onclick="javascript:pictureparkWidgets.players.showPrevious(\'{{ config.token }}\', \'gallery_{{ id }}\')"\n            class="picturepark-widget-card-navigation-previous picturepark-widget-card-navigation-previous-{{id}}">\n            <svg style="position: absolute; top: 50%; transform: translate(0,-50%);" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42.8 42.8"><path d="M11 21.7l18 20c0.1 0.1 0.2 0.2 0.4 0.2 0.1 0 0.3 0 0.4-0.1l2.9-2.9c0.2-0.2 0.2-0.5 0-0.7L17.9 21.3 32.7 4.6c0.2-0.2 0.2-0.5 0-0.7L29.7 1c-0.1-0.1-0.2-0.1-0.4-0.1h0c-0.1 0-0.3 0.1-0.4 0.2L11 21c-0.1 0.1-0.1 0.2-0.1 0.3C10.8 21.4 10.8 21.6 11 21.7z" fill="#CCCCCC"/></svg>\n          </a>\n          <a href="javascript:void(0)" onclick="javascript:pictureparkWidgets.players.showNext(\'{{ config.token }}\', \'gallery_{{ id }}\')"\n            class="picturepark-widget-card-navigation-next picturepark-widget-card-navigation-next-{{id}}">\n            <svg style="position: absolute; top: 50%; transform: translate(0,-50%);" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42.8 42.8"><path d="M32.7 21l-18-20c-0.1-0.1-0.2-0.2-0.4-0.2 -0.1 0-0.3 0-0.4 0.1L11 3.9c-0.2 0.2-0.2 0.5 0 0.7l14.8 16.7L11 38.1c-0.2 0.2-0.2 0.5 0 0.7l2.9 2.9c0.1 0.1 0.2 0.1 0.4 0.1h0c0.1 0 0.3-0.1 0.4-0.2l18-20c0.1-0.1 0.1-0.2 0.1-0.3C32.8 21.3 32.8 21.1 32.7 21z" fill="#CCCCCC"/></svg>\n          </a>\n          {% endif %}\n        </div>\n\n        {% if config.showFooter %}\n        <div class="picturepark-widget-card-footer-content picturepark-widget-card-footer-content-{{id}}">\n          <div class="picturepark-widget-card-footer-title picturepark-widget-card-footer-title-{{id}}">{{ share.name }}</div>\n          {% if share.description %}\n            <div class="picturepark-widget-card-footer-description picturepark-widget-card-footer-description-{{id}}">{{ share.description }}</div>\n          {% endif %}\n          <hr class="picturepark-widget-card-footer-hr picturepark-widget-card-footer-hr-{{id}}">\n          <div class="picturepark-widget-card-footer-gravatar picturepark-widget-card-footer-gravatar-{{id}}">\n            <img src="//www.gravatar.com/avatar/{{ share.creator.emailHash }}?m=dd&size=32&d=mm" class="picturepark-widget-card-footer-gravatar picturepark-widget-card-footer-gravatar-{{id}}" />\n            Shared by: {{ share.creator.displayName }}\n            </div>\n        </div>\n        {% endif %}\n      </div>'}static getList(){return'\n      {% if config.renderStyles %}\n      <style>\n        .picturepark-widget-{{id}} {\n          all: initial;\n          font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;\n          font-size: 13px;\n          float: left;\n          margin-right: 4px;\n          margin-bottom: 4px;\n        }\n        .picturepark-widget-list-{{id}} {\n          padding: 0px 12px 0px 12px;\n          position: relative;\n          border: 1px solid lightgray;\n          border-radius: 4px;\n        }\n        .picturepark-widget-list-header-{{id}} {\n          font-weight: bold;\n          font-size: 16px;\n          border-bottom: 2px solid #DCDCDC; \n          margin: 12px 0 16px 0; \n          padding: 0 0 12px 0; \n        }\n        .picturepark-widget-list-header-download-{{id}} {\n          font-size: 10pt; \n          padding-top: 3px; \n        }\n        .picturepark-widget-list-body-{{id}} {\n          list-style-type: none;\n          margin: 0 0 8px 0; \n          padding: 0;\n        }\n        .picturepark-widget-list-body-{{id}} li {\n          margin-bottom: 8px;\n        }\n      </style>\n      {% endif %}\n\n      <div class="picturepark-widget-list picturepark-widget-list-{{id}}" style="width: {{ config.width }}px">\n        <h1 class="picturepark-widget-list-header picturepark-widget-list-header-{{id}}">\n          {% translate \'List.HeaderDownloads\' %}\n          <span style="float:right" class="picturepark-widget-list-header-download picturepark-widget-list-header-download-{{id}}">\n            <a href="{{ share.url }}">{% translate \'List.ButtonDownloadAll\' %}</a>\n          </span>\n        </h1>\n        <ul class="picturepark-widget-list-body picturepark-widget-list-body-{{id}}">\n        {% for selection in share.items %}\n          <li>\n            <span style="float:right">\n              <a href="{{selection.originalUrl}}">\n                <svg height="19px" version="1.1" viewBox="0 0 14 19" width="14px" xmlns="http://www.w3.org/2000/svg" \n                     xmlns:sketch="http://www.bohemiancoding.com/sketch/ns" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <title/><desc/><defs/>\n                  <g fill="none" fill-rule="evenodd" id="Page-1" stroke="none" stroke-width="1">\n                    <g fill="#000000" id="Core" transform="translate(-383.000000, -213.000000)">\n                      <g id="file-download" transform="translate(383.000000, 213.500000)">\n                        <path d="M14,6 L10,6 L10,0 L4,0 L4,6 L0,6 L7,13 L14,6 L14,6 Z M0,15 L0,17 L14,17 L14,15 L0,15 L0,15 Z" id="Shape"/>\n                      </g>\n                    </g>\n                  </g>\n                </svg>\n              </a>\n            </span>\n            <span>\n              <strong>{{ selection.displayValues.list }}</strong><br />\n              TBD\n            </span>\n          </li>\n        {% endfor %}\n        </ul>\n      </div>'}}function log(e){console&&console.log(e)}class PictureparkPlayers{static showPrevious(e,t){let r=document.pictureparkShareCache[e],n=PictureparkPlayers.getGallery(t);r.player&&r.player.stop();let i=n.index-1;i<0&&(i=n.children.length-1),PictureparkPlayers.showGalleryItem(n,i)}static showNext(e,t){let r=document.pictureparkShareCache[e],n=PictureparkPlayers.getGallery(t);r.player&&r.player.stop();let i=n.index+1;i===n.children.length&&(i=0),PictureparkPlayers.showGalleryItem(n,i)}static showGalleryItem(e,t){e.index!==t&&(e.children[e.index].element.style.display="none",e.children[t].element.style.display="")}static getGallery(e){let t=[],r=-1,n=document.getElementById(e);if(n){for(var i=0;i<n.children.length;i++){let e=n.children[i],s="none"!==e.style.display;t.push({index:i,visible:s,element:e}),s&&(r=i)}return{children:t,index:r}}return null}static showDetail(e,t,r){if(PictureparkPlayers.loading)return;PictureparkPlayers.loading=!0;let n=document.pictureparkShareCache[e];PictureparkPlayers.showDetailById(t,n.items,r)}static showDetailById(e,t,r){let n=t.filter((t=>t.id===e))[0];if(n.isPdf&&1===t.length)this.showPdfJsItem(n),PictureparkPlayers.loading=!1;else{let e=document.body.style.overflow;document.body.style.overflow="hidden",this.showPhotoSwipeItem(n,t,r?"gallery_"+r:void 0).then((()=>{PictureparkPlayers.loading=!1,document.body.style.overflow=e}))}}static disposeVideoPlayer(e){if(PictureparkPlayers.loadedPlayers.filter((t=>t.element===e.id_))[0]){log("Fotoware Alto Widgets > Disposed videojs player");try{e.dispose()}catch(e){}PictureparkPlayers.loadedPlayers=PictureparkPlayers.loadedPlayers.filter((t=>t.player!==e))}else log("Fotoware Alto Widgets > Player could not be disposed"+e)}static renderVideoPlayerIfNeeded(e,t,r,n){let i=PictureparkPlayers.loadedPlayers.filter((e=>e.element===t.id))[0];return i?i.promise.then((t=>{let s=document.getElementById(i.element);return s&&s.tagName&&"video"!==s.tagName.toLowerCase()&&"audio"!==s.tagName.toLowerCase()?(log("Fotoware Alto Widgets > Reused videojs player: "+s.id),t):(t&&PictureparkPlayers.disposeVideoPlayer(t),PictureparkPlayers.renderVideoPlayer(s,e,r,n).then((e=>(i.player=e,log("Fotoware Alto Widgets > Reloaded videojs player: "+s.id),e))))})):(PictureparkPlayers.loadedPlayers=PictureparkPlayers.loadedPlayers.filter((e=>e.element!==t.id_)),i={element:t.id,promise:PictureparkPlayers.renderVideoPlayer(t,e,r,n).then((e=>(log("Fotoware Alto Widgets > Created videojs player: "+t.id),e)))},PictureparkPlayers.loadedPlayers.push(i),i.promise)}static renderVideoPlayer(e,t,r,n){return this.loadVideoPlayerLibraries().then((i=>new Promise((s=>{var a=i(e,{autoplay:!1,controls:!0,poster:t.previewUrl,width:r,height:n,preload:"auto"},(()=>{s(a)}));return a.src({type:t.isMovie?"video/mp4":"audio/mp3",src:t.isMovie?t.videoUrl:t.audioUrl}),a}))))}static loadVideoPlayerLibraries(){return window.videojs?Promise.resolve(window.videojs):Promise.all([this.loadCss("https://vjs.zencdn.net/7.0.3/video-js.css"),this.loadScript("https://vjs.zencdn.net/7.0.3/video.js","videojs")]).then((([e,t])=>t))}static showPdfJsItem(e){let t=document.createElement("iframe");t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.width="100%",t.style.height="100%",t.src=PictureparkPlayers.scriptsPath+"pdfjs-dist/web/viewer.html?file="+e.pdfUrl;let r=document.body.style.overflow,n=e=>{let t=e||window.event;("key"in t?"Escape"==t.key||"Esc"==t.key:27==t.keyCode)&&i()},i=()=>{document.body.removeChild(t),document.body.style.overflow=r,document.removeEventListener("keydown",n,!0)},s=!1;t.onload=e=>{document.body.style.overflow="hidden",s?i():s=!0},document.addEventListener("keydown",n,!0),document.body.appendChild(t)}static showPhotoSwipeItem(e,t,r){return this.loadPhotoSwipe().then((n=>{t||(t=[e]);let i=t.map((e=>e.isImage&&e.detail?{src:e.previewUrl,w:e.detail.width,h:e.detail.height,origin:e.originalUrl}:e.isPdf?{html:'<iframe style="position: absolute; left: 0; top: 40px; width: 100%; height: calc(100% - 40px)" src="'+PictureparkPlayers.scriptsPath+"pdfjs-dist/web/viewer.html?file="+e.pdfUrl+'&closeButton=false" id="pdfjs_'+e.id+'"></iframe>',origin:e.originalUrl}:e.isMovie?{html:'<video class="video-js vjs-big-play-centered" id="vjsplayer_'+e.id+'"></video>',origin:e.originalUrl}:e.isAudio?{html:'<audio class="video-js vjs-big-play-centered" id="vjsplayer_'+e.id+'"></audio>',origin:e.originalUrl}:e.isBinary?{src:e.previewUrl+"?width=800&height=800",w:800,h:800,origin:e.originalUrl}:{html:'<br /><br /><br /><br /><div class="picturepark-widget-content-preview"> '+e.displayValues.detail+"</div>",origin:e.originalUrl}));var s=new n.photoSwipe(n.element,n.photoSwipeDefault,i,{index:t.indexOf(e)});s.options.history=!1,s.options.shareButtons=[{id:"download",label:"Download",url:"{{raw_image_url}}",download:!0}],s.options.getImageURLForShare=e=>s.currItem.origin||s.currItem.src||"",s.init(),s.listen("afterChange",(function(){let e=r?PictureparkPlayers.getGallery(r):void 0;e&&PictureparkPlayers.showGalleryItem(e,s.getCurrentIndex())}));var a=[],o=[];if(t.filter((e=>e.isMovie||e.isAudio||e.isPdf)).length>0){var l=()=>{t.filter((e=>e.isMovie||e.isAudio)).length>0&&PictureparkPlayers.loadVideoPlayerLibraries().then((()=>{for(let e of t.filter((e=>e.isMovie||e.isAudio))){let t="vjsplayer_"+e.id,r=document.getElementById(t);r&&PictureparkPlayers.renderVideoPlayerIfNeeded(e,r,window.innerWidth,window.innerHeight).then((e=>{e&&o.push(e)}))}}));for(let e of t.filter((e=>e.isPdf))){let t="pdfjs_"+e.id,r=document.getElementById(t);r&&(r.onload=()=>{"about:blank"===r.contentWindow.location.href&&s.close()})}};s.listen("afterChange",(()=>{l(),s.listen("beforeChange",(()=>{l()}))})),l()}return new Promise((e=>{s.listen("close",(()=>{for(let e of o)this.disposeVideoPlayer(e);for(let e of a)window.removeEventListener("resize",e,!1);e()}))}))}))}static loadPhotoSwipe(){return window.PhotoSwipe?Promise.resolve({element:PictureparkPlayers.getPhotoSwipeElement(),photoSwipe:window.PhotoSwipe,photoSwipeDefault:window.PhotoSwipeUI_Default}):Promise.all([this.loadCss("https://cdn.rawgit.com/dimsemenov/PhotoSwipe/master/dist/photoswipe.css"),this.loadCss("https://cdn.rawgit.com/dimsemenov/PhotoSwipe/master/dist/default-skin/default-skin.css"),this.loadScript("https://cdn.rawgit.com/dimsemenov/PhotoSwipe/master/dist/photoswipe.min.js","PhotoSwipe"),this.loadScript("https://cdn.rawgit.com/dimsemenov/PhotoSwipe/master/dist/photoswipe-ui-default.min.js","PhotoSwipeUI_Default")]).then((([e,t,r,n])=>({element:PictureparkPlayers.getPhotoSwipeElement(),photoSwipe:r,photoSwipeDefault:n})))}static getPhotoSwipeElement(){let e=document.querySelectorAll(".pswp")[0];if(e)return e;var t=document.createElement("div");return t.id="photoswipe",t.innerHTML='\n        <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">\n            <div class="pswp__bg"></div>\n            <div class="pswp__scroll-wrap">\n                <div class="pswp__container">\n                    <div class="pswp__item"></div>\n                    <div class="pswp__item"></div>\n                    <div class="pswp__item"></div>\n                </div>\n                <div class="pswp__ui pswp__ui--hidden">\n                    <div class="pswp__top-bar">\n                        <div class="pswp__counter"></div>\n                        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>\n                        <button class="pswp__button pswp__button--share" title="Share"></button>\n                        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>\n                        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>\n                        <div class="pswp__preloader">\n                            <div class="pswp__preloader__icn">\n                            <div class="pswp__preloader__cut">\n                                <div class="pswp__preloader__donut"></div>\n                            </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">\n                        <div class="pswp__share-tooltip"></div> \n                    </div>\n                    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>\n                    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>\n                    <div class="pswp__caption">\n                        <div class="pswp__caption__center"></div>\n                    </div>\n                </div>\n            </div>\n        </div>',document.body.appendChild(t),document.querySelectorAll(".pswp")[0]}static loadScript(e,t){return window.require?(log("Fotoware Alto Widgets > Load external script via require(): "+e),new Promise((t=>{window.require([e],(e=>{t(e)}))}))):(log("Fotoware Alto Widgets > Load external script via tag: "+e),new Promise((r=>{var n=document.createElement("script");n.src=e,n.async=!0,n.onload=()=>{r(window[t])},document.head.appendChild(n)})))}static loadCss(e){return new Promise((t=>{var r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,r.onload=()=>t(),document.getElementsByTagName("head")[0].appendChild(r)}))}}PictureparkPlayers.loading=!1,PictureparkPlayers.scriptsPath=void 0,PictureparkPlayers.loadedPlayers=[];var TRANSLATIONS={List:{HeaderDownloads:{en:"Downloads",de:"Downloads"},ButtonDownloadAll:{en:"Download all",de:"Alle herunterladen"}},AudioPreview:{en:"Audio waveform preview",de:"Audio-Wellenform Voransicht"},AudioSmall:{en:"Audio",de:"Audio"},DocumentPreview:{en:"Document preview",de:"Dokument Voransicht"},Original:{en:"Original",de:"Original"},Pdf:{en:"PDF",de:"PDF"},Preview:{en:"Preview",de:"Voransicht"},ThumbnailLarge:{en:"Large thumbnail",de:"Vorschau gross"},ThumbnailMedium:{en:"Medium thumbnail",de:"Vorschau mittel"},ThumbnailSmall:{en:"Small thumbnail",de:"Vorschau klein"},VideoKeyframes:{en:"Video keyframes",de:"Video-Keyframes"},VideoLarge:{en:"Large video",de:"Video gross"},VideoPreview:{en:"Video preview",de:"Video Voransicht"},VideoSmall:{en:"Small video",de:"Video klein"}},fallbackLanguage="en";function translate(e,t){let r=t?t.split("-")[0].toLowerCase():"",n=TRANSLATIONS;if("string"==typeof e){let t=e.split(".");if(t.length>0)for(let e of t){if(!n[e]){n=null;break}n=n[e]}else n=null}else n=e;return n&&n[r]?n[r]:r!==fallbackLanguage?translate(e,fallbackLanguage+"-"):`[!${e}]`}class PictureparkRenderEngine{static create(){let e=Liquid();return e.registerTag("translate",{parse:function(e){this.token=e},render:function(e,t){let r=this.token.args.split(" ");return translate(Liquid.evalExp(r[0],e),navigator.language||navigator.userLanguage)}}),e.registerTag("resizeById",{parse:function(e){this.token=e},render:function(e,t){let r=this.token.args.split(" "),n=e.scopes[0].share,i=Liquid.evalExp(r[0],e),s=Liquid.evalExp(r[1],e),a=Liquid.evalExp(r[2],e),o=Liquid.evalExp(r[3],e);try{let e=n.items.filter((e=>e.id===i))[0];if("Preview"===s&&e.previewUrl)return e.previewUrl+`?width=${a}&height=${o}`;{let t=e.outputs.find((e=>"Original"===e.outputFormatId));return t?t.viewUrl+`?width=${a}&height=${o}`:e.originalUrl+`?width=${a}&height=${o}`}}catch(e){return""}}}),e}}class PictureparkConfig{static get(e){let t={renderStyles:!0};for(var r=0;r<e.attributes.length;r++){var n=e.attributes[r];if("data-token"===n.name)t.token=n.value;else if("data-template"===n.name)t.template=n.value;else if("data-picturepark-server"===n.name)t.server=n.value;else if("data-show-players"===n.name)t.showPlayers="true"===n.value.toLowerCase()||"yes"===n.value.toLowerCase();else if("data-render-styles"===n.name)t.renderStyles="false"!==n.value.toLowerCase()&&"no"!==n.value.toLowerCase();else if("data-width"===n.name)t.width=parseInt(n.value),void 0===t.height&&(t.height=3*t.width/4);else if("data-height"===n.name)t.height=parseInt(n.value),void 0===t.width&&(t.width=4*t.height/3);else if(0===n.name.indexOf("data-")){let e;switch(n.value){case"false":e=!1;break;case"true":e=!0;break;default:e=n.value}t[n.name.substr(5).replace(/-([a-z])/g,(e=>e[1].toUpperCase()))]=e}}return t}}function processScriptTag(e){if(e.isPictureparkProcessing)return;e.isPictureparkProcessing=!0;var t="Loading...",r="Failed to load data.",n="";let i=Math.random().toString(36).substr(2,10);var s="picturepark_widget_"+i;let a=PictureparkConfig.get(e);if(e.innerHTML){var o=document.createElement("div");o.innerHTML=e.innerHTML;var l=o.children;l.loading&&(t=l.loading.innerHTML),l.content&&(n=l.content.innerHTML),l.error&&(r=l.error.innerHTML),!l.loading&&l.content&&l.error&&(n=e.innerHTML)}return e.outerHTML='<div class="picturepark-widget picturepark-widget-loading" id='+s+">"+t+"</div>",window.fetch(a.server+"/json/"+a.token).then((e=>e.json())).then((e=>{let t={template:"gallery",token:"",width:void 0,height:void 0};Object.keys(a).forEach((e=>{t[e]=a[e]})),""===n&&(n=PictureparkTemplates.getTemplate("card"));let r=0,o={id:e.id,url:e.data.url,name:e.name,creator:e.creator,description:e.description,items:e.contentSelections.map((e=>{let t,n=e.outputs.map((t=>({contentId:e.id,outputFormatId:t.outputFormatId,fileExtension:t.detail?t.detail.fileExtension:null,viewUrl:t.viewUrl,downloadUrl:t.downloadUrl,detail:t.detail}))),i=n.find((e=>"Preview"===e.outputFormatId));t=n.find((e=>"Original"===e.outputFormatId));var s=e.outputs.find((e=>"Pdf"===e.outputFormatId));return{id:e.id,index:r++,displayValues:e.displayValues,detail:t?t.detail:null,isMovie:"VideoMetadata"===e.contentSchemaId,isAudio:"AudioMetadata"===e.contentSchemaId,isImage:"ImageMetadata"===e.contentSchemaId,isPdf:void 0!==s,isBinary:"ContentItem"!==e.contentType,previewUrl:i?i.viewUrl:t&&"ImageMetadata"===e.contentSchemaId?t.viewUrl:e.iconUrl,previewOutputFormatId:i?i.outputFormatId:null,originalUrl:t?t.downloadUrl:null,originalOutputFormatId:t?t.outputFormatId:null,pdfUrl:s?s.downloadUrl:null,videoUrl:e.outputs.find((e=>"VideoLarge"===e.outputFormatId))?e.outputs.find((e=>"VideoLarge"===e.outputFormatId)).downloadUrl:e.outputs.find((e=>"VideoSmall"===e.outputFormatId))?e.outputs.find((e=>"VideoSmall"===e.outputFormatId)).downloadUrl:null,audioUrl:e.outputs.find((e=>"AudioSmall"===e.outputFormatId))?e.outputs.find((e=>"AudioSmall"===e.outputFormatId)).downloadUrl:null,outputs:n}}))};return document.pictureparkShareCache||(document.pictureparkShareCache={}),document.pictureparkShareCache[t.token]=o,PictureparkRenderEngine.create().parseAndRender(n,{id:i,elementId:s,share:o,config:t}).then((e=>{e='<div class="picturepark-widget picturepark-widget-'+i+' picturepark-widget-loaded">'+e+"</div>",document.getElementById(s).outerHTML=e;for(let e of o.items)if(e.isMovie||e.isAudio){let r="vjsplayer_"+e.index+"_"+i;setTimeout((()=>{let n=document.getElementById(r);n&&PictureparkPlayers.renderVideoPlayerIfNeeded(e,n,t.width,t.height).then((e=>{o.player=e}))}))}return"gallery"===t.template&&setTimeout((()=>{const e=document.getElementsByClassName("picturepark-widget-gallery-item-outputs-"+i),t=function(e){const t=document.getElementsByClassName("picturepark-widget-gallery-item-outputs-dropdown-"+i);for(let r=0;r<t.length;r++){const n=t[r];n.classList.contains("show")&&n!==e&&n.classList.remove("show")}};for(let r=0;r<e.length;r++)e[r].addEventListener("click",function(n){n.stopPropagation();const i=e[r].nextElementSibling;t(i),i.classList.toggle("show")}.bind(this));window.onclick=function(e){e.target.matches(".picturepark-widget-gallery-item-outputs-"+i)||t()}})),!0}))})).catch((e=>(console.error(e),document.getElementById(s).outerHTML='<div class="picturepark-widget picturepark-widget-error">'+r+"</div>",!1)))}function getScriptsPath(){let e=document.getElementsByTagName("script");for(var t=0;t<e.length;t++){var r=e[t],n=r.src.indexOf("picturepark-widgets.js");if(-1!==n)return r.src.substring(0,n)}}void 0===PictureparkPlayers.scriptsPath&&(PictureparkPlayers.scriptsPath=getScriptsPath()),setTimeout((()=>{for(var e=document.getElementsByTagName("script"),t=0;t<e.length;++t){var r=e[t];r.hasAttribute("data-picturepark-server")&&processScriptTag(r)}})),exports.players=PictureparkPlayers,exports.processScriptTag=processScriptTag;
